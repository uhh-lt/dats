import random
from itertools import cycle
from typing import Dict, Tuple

from frozendict import frozendict

"""
from matplot lib CSS colors palette with name and rgb value
"""

__matplotlib_css_colors__ = frozendict(
    {
        "black": (0.0, 0.0, 0.0),
        "dimgray": (0.4117647058823529, 0.4117647058823529, 0.4117647058823529),
        "dimgrey": (0.4117647058823529, 0.4117647058823529, 0.4117647058823529),
        "gray": (0.5019607843137255, 0.5019607843137255, 0.5019607843137255),
        "grey": (0.5019607843137255, 0.5019607843137255, 0.5019607843137255),
        "darkgray": (0.6627450980392157, 0.6627450980392157, 0.6627450980392157),
        "darkgrey": (0.6627450980392157, 0.6627450980392157, 0.6627450980392157),
        "silver": (0.7529411764705882, 0.7529411764705882, 0.7529411764705882),
        "lightgray": (0.8274509803921568, 0.8274509803921568, 0.8274509803921568),
        "lightgrey": (0.8274509803921568, 0.8274509803921568, 0.8274509803921568),
        "gainsboro": (0.8627450980392157, 0.8627450980392157, 0.8627450980392157),
        "whitesmoke": (0.9607843137254902, 0.9607843137254902, 0.9607843137254902),
        "white": (1.0, 1.0, 1.0),
        "snow": (1.0, 0.9803921568627451, 0.9803921568627451),
        "rosybrown": (0.7372549019607844, 0.5607843137254902, 0.5607843137254902),
        "lightcoral": (0.9411764705882353, 0.5019607843137255, 0.5019607843137255),
        "indianred": (0.803921568627451, 0.3607843137254902, 0.3607843137254902),
        "brown": (0.6470588235294118, 0.16470588235294117, 0.16470588235294117),
        "firebrick": (0.6980392156862745, 0.13333333333333333, 0.13333333333333333),
        "maroon": (0.5019607843137255, 0.0, 0.0),
        "darkred": (0.5450980392156862, 0.0, 0.0),
        "red": (1.0, 0.0, 0.0),
        "mistyrose": (1.0, 0.8941176470588236, 0.8823529411764706),
        "salmon": (0.9803921568627451, 0.5019607843137255, 0.4470588235294118),
        "tomato": (1.0, 0.38823529411764707, 0.2784313725490196),
        "darksalmon": (0.9137254901960784, 0.5882352941176471, 0.47843137254901963),
        "coral": (1.0, 0.4980392156862745, 0.3137254901960784),
        "orangered": (1.0, 0.27058823529411763, 0.0),
        "lightsalmon": (1.0, 0.6274509803921569, 0.47843137254901963),
        "sienna": (0.6274509803921569, 0.3215686274509804, 0.17647058823529413),
        "seashell": (1.0, 0.9607843137254902, 0.9333333333333333),
        "chocolate": (0.8235294117647058, 0.4117647058823529, 0.11764705882352941),
        "saddlebrown": (0.5450980392156862, 0.27058823529411763, 0.07450980392156863),
        "sandybrown": (0.9568627450980393, 0.6431372549019608, 0.3764705882352941),
        "peachpuff": (1.0, 0.8549019607843137, 0.7254901960784313),
        "peru": (0.803921568627451, 0.5215686274509804, 0.24705882352941178),
        "linen": (0.9803921568627451, 0.9411764705882353, 0.9019607843137255),
        "bisque": (1.0, 0.8941176470588236, 0.7686274509803922),
        "darkorange": (1.0, 0.5490196078431373, 0.0),
        "burlywood": (0.8705882352941177, 0.7215686274509804, 0.5294117647058824),
        "antiquewhite": (0.9803921568627451, 0.9215686274509803, 0.8431372549019608),
        "tan": (0.8235294117647058, 0.7058823529411765, 0.5490196078431373),
        "navajowhite": (1.0, 0.8705882352941177, 0.6784313725490196),
        "blanchedalmond": (1.0, 0.9215686274509803, 0.803921568627451),
        "papayawhip": (1.0, 0.9372549019607843, 0.8352941176470589),
        "moccasin": (1.0, 0.8941176470588236, 0.7098039215686275),
        "orange": (1.0, 0.6470588235294118, 0.0),
        "wheat": (0.9607843137254902, 0.8705882352941177, 0.7019607843137254),
        "oldlace": (0.9921568627450981, 0.9607843137254902, 0.9019607843137255),
        "floralwhite": (1.0, 0.9803921568627451, 0.9411764705882353),
        "darkgoldenrod": (0.7215686274509804, 0.5254901960784314, 0.043137254901960784),
        "goldenrod": (0.8549019607843137, 0.6470588235294118, 0.12549019607843137),
        "cornsilk": (1.0, 0.9725490196078431, 0.8627450980392157),
        "gold": (1.0, 0.8431372549019608, 0.0),
        "lemonchiffon": (1.0, 0.9803921568627451, 0.803921568627451),
        "khaki": (0.9411764705882353, 0.9019607843137255, 0.5490196078431373),
        "palegoldenrod": (0.9333333333333333, 0.9098039215686274, 0.6666666666666666),
        "darkkhaki": (0.7411764705882353, 0.7176470588235294, 0.4196078431372549),
        "ivory": (1.0, 1.0, 0.9411764705882353),
        "beige": (0.9607843137254902, 0.9607843137254902, 0.8627450980392157),
        "lightyellow": (1.0, 1.0, 0.8784313725490196),
        "lightgoldenrodyellow": (
            0.9803921568627451,
            0.9803921568627451,
            0.8235294117647058,
        ),
        "olive": (0.5019607843137255, 0.5019607843137255, 0.0),
        "yellow": (1.0, 1.0, 0.0),
        "olivedrab": (0.4196078431372549, 0.5568627450980392, 0.13725490196078433),
        "yellowgreen": (0.6039215686274509, 0.803921568627451, 0.19607843137254902),
        "darkolivegreen": (0.3333333333333333, 0.4196078431372549, 0.1843137254901961),
        "greenyellow": (0.6784313725490196, 1.0, 0.1843137254901961),
        "chartreuse": (0.4980392156862745, 1.0, 0.0),
        "lawngreen": (0.48627450980392156, 0.9882352941176471, 0.0),
        "honeydew": (0.9411764705882353, 1.0, 0.9411764705882353),
        "darkseagreen": (0.5607843137254902, 0.7372549019607844, 0.5607843137254902),
        "palegreen": (0.596078431372549, 0.984313725490196, 0.596078431372549),
        "lightgreen": (0.5647058823529412, 0.9333333333333333, 0.5647058823529412),
        "forestgreen": (0.13333333333333333, 0.5450980392156862, 0.13333333333333333),
        "limegreen": (0.19607843137254902, 0.803921568627451, 0.19607843137254902),
        "darkgreen": (0.0, 0.39215686274509803, 0.0),
        "green": (0.0, 0.5019607843137255, 0.0),
        "lime": (0.0, 1.0, 0.0),
        "seagreen": (0.1803921568627451, 0.5450980392156862, 0.3411764705882353),
        "mediumseagreen": (
            0.23529411764705882,
            0.7019607843137254,
            0.44313725490196076,
        ),
        "springgreen": (0.0, 1.0, 0.4980392156862745),
        "mintcream": (0.9607843137254902, 1.0, 0.9803921568627451),
        "mediumspringgreen": (0.0, 0.9803921568627451, 0.6039215686274509),
        "mediumaquamarine": (0.4, 0.803921568627451, 0.6666666666666666),
        "aquamarine": (0.4980392156862745, 1.0, 0.8313725490196079),
        "turquoise": (0.25098039215686274, 0.8784313725490196, 0.8156862745098039),
        "lightseagreen": (0.12549019607843137, 0.6980392156862745, 0.6666666666666666),
        "mediumturquoise": (0.2823529411764706, 0.8196078431372549, 0.8),
        "azure": (0.9411764705882353, 1.0, 1.0),
        "lightcyan": (0.8784313725490196, 1.0, 1.0),
        "paleturquoise": (0.6862745098039216, 0.9333333333333333, 0.9333333333333333),
        "darkslategray": (0.1843137254901961, 0.30980392156862746, 0.30980392156862746),
        "darkslategrey": (0.1843137254901961, 0.30980392156862746, 0.30980392156862746),
        "teal": (0.0, 0.5019607843137255, 0.5019607843137255),
        "darkcyan": (0.0, 0.5450980392156862, 0.5450980392156862),
        "aqua": (0.0, 1.0, 1.0),
        "cyan": (0.0, 1.0, 1.0),
        "darkturquoise": (0.0, 0.807843137254902, 0.8196078431372549),
        "cadetblue": (0.37254901960784315, 0.6196078431372549, 0.6274509803921569),
        "powderblue": (0.6901960784313725, 0.8784313725490196, 0.9019607843137255),
        "lightblue": (0.6784313725490196, 0.8470588235294118, 0.9019607843137255),
        "deepskyblue": (0.0, 0.7490196078431373, 1.0),
        "skyblue": (0.5294117647058824, 0.807843137254902, 0.9215686274509803),
        "lightskyblue": (0.5294117647058824, 0.807843137254902, 0.9803921568627451),
        "steelblue": (0.27450980392156865, 0.5098039215686274, 0.7058823529411765),
        "aliceblue": (0.9411764705882353, 0.9725490196078431, 1.0),
        "dodgerblue": (0.11764705882352941, 0.5647058823529412, 1.0),
        "lightslategray": (0.4666666666666667, 0.5333333333333333, 0.6),
        "lightslategrey": (0.4666666666666667, 0.5333333333333333, 0.6),
        "slategray": (0.4392156862745098, 0.5019607843137255, 0.5647058823529412),
        "slategrey": (0.4392156862745098, 0.5019607843137255, 0.5647058823529412),
        "lightsteelblue": (0.6901960784313725, 0.7686274509803922, 0.8705882352941177),
        "cornflowerblue": (0.39215686274509803, 0.5843137254901961, 0.9294117647058824),
        "royalblue": (0.2549019607843137, 0.4117647058823529, 0.8823529411764706),
        "ghostwhite": (0.9725490196078431, 0.9725490196078431, 1.0),
        "lavender": (0.9019607843137255, 0.9019607843137255, 0.9803921568627451),
        "midnightblue": (0.09803921568627451, 0.09803921568627451, 0.4392156862745098),
        "navy": (0.0, 0.0, 0.5019607843137255),
        "darkblue": (0.0, 0.0, 0.5450980392156862),
        "mediumblue": (0.0, 0.0, 0.803921568627451),
        "blue": (0.0, 0.0, 1.0),
        "slateblue": (0.41568627450980394, 0.35294117647058826, 0.803921568627451),
        "darkslateblue": (0.2823529411764706, 0.23921568627450981, 0.5450980392156862),
        "mediumslateblue": (
            0.4823529411764706,
            0.40784313725490196,
            0.9333333333333333,
        ),
        "mediumpurple": (0.5764705882352941, 0.4392156862745098, 0.8588235294117647),
        "rebeccapurple": (0.4, 0.2, 0.6),
        "blueviolet": (0.5411764705882353, 0.16862745098039217, 0.8862745098039215),
        "indigo": (0.29411764705882354, 0.0, 0.5098039215686274),
        "darkorchid": (0.6, 0.19607843137254902, 0.8),
        "darkviolet": (0.5803921568627451, 0.0, 0.8274509803921568),
        "mediumorchid": (0.7294117647058823, 0.3333333333333333, 0.8274509803921568),
        "thistle": (0.8470588235294118, 0.7490196078431373, 0.8470588235294118),
        "plum": (0.8666666666666667, 0.6274509803921569, 0.8666666666666667),
        "violet": (0.9333333333333333, 0.5098039215686274, 0.9333333333333333),
        "purple": (0.5019607843137255, 0.0, 0.5019607843137255),
        "darkmagenta": (0.5450980392156862, 0.0, 0.5450980392156862),
        "fuchsia": (1.0, 0.0, 1.0),
        "magenta": (1.0, 0.0, 1.0),
        "orchid": (0.8549019607843137, 0.4392156862745098, 0.8392156862745098),
        "mediumvioletred": (
            0.7803921568627451,
            0.08235294117647059,
            0.5215686274509804,
        ),
        "deeppink": (1.0, 0.0784313725490196, 0.5764705882352941),
        "hotpink": (1.0, 0.4117647058823529, 0.7058823529411765),
        "lavenderblush": (1.0, 0.9411764705882353, 0.9607843137254902),
        "palevioletred": (0.8588235294117647, 0.4392156862745098, 0.5764705882352941),
        "crimson": (0.8627450980392157, 0.0784313725490196, 0.23529411764705882),
        "pink": (1.0, 0.7529411764705882, 0.796078431372549),
        "lightpink": (1.0, 0.7137254901960784, 0.7568627450980392),
    }
)


__fynns_color_palette__ = cycle(
    [
        "rgb(0,255,0)",
        "rgb(185,0,255)",
        "rgb(255,52,0)",
        "rgb(27,220,255)",
        "rgb(255,232,135)",
        "rgb(255,123,181)",
        "rgb(3,128,255)",
        "rgb(32,255,176)",
        "rgb(76,153,0)",
        "rgb(255,228,229)",
        "rgb(238,255,0)",
        "rgb(254,159,0)",
        "rgb(255,0,91)",
        "rgb(255,1,203)",
        "rgb(211,178,255)",
        "rgb(160,81,204)",
        "rgb(150,225,193)",
        "rgb(182,255,129)",
        "rgb(172,161,0)",
        "rgb(17,157,233)",
        "rgb(255,124,73)",
        "rgb(8,246,106)",
        "rgb(255,0,147)",
        "rgb(102,91,255)",
        "rgb(138,229,26)",
        "rgb(1,177,90)",
        "rgb(182,214,255)",
        "rgb(0,255,244)",
        "rgb(253,255,203)",
        "rgb(255,142,243)",
        "rgb(252,176,92)",
        "rgb(199,56,163)",
        "rgb(255,214,0)",
        "rgb(233,87,255)",
        "rgb(253,180,218)",
        "rgb(222,234,85)",
        "rgb(175,219,142)",
        "rgb(225,45,47)",
        "rgb(208,255,255)",
        "rgb(134,121,220)",
        "rgb(0,200,155)",
        "rgb(255,114,0)",
        "rgb(0,189,27)",
        "rgb(255,83,133)",
        "rgb(151,192,79)",
        "rgb(153,255,186)",
        "rgb(247,203,76)",
        "rgb(149,191,0)",
        "rgb(255,0,255)",
        "rgb(255,214,158)",
        "rgb(100,237,129)",
        "rgb(197,45,194)",
        "rgb(152,121,255)",
        "rgb(81,210,211)",
        "rgb(161,64,241)",
        "rgb(137,166,255)",
        "rgb(110,205,75)",
        "rgb(210,66,5)",
        "rgb(203,149,7)",
        "rgb(245,217,255)",
        "rgb(103,255,73)",
        "rgb(231,255,146)",
        "rgb(45,254,209)",
        "rgb(207,147,255)",
        "rgb(255,94,217)",
        "rgb(17,125,221)",
        "rgb(198,193,81)",
        "rgb(230,128,35)",
        "rgb(207,255,72)",
        "rgb(91,190,240)",
        "rgb(227,148,217)",
        "rgb(227,122,255)",
        "rgb(108,206,131)",
        "rgb(213,228,207)",
        "rgb(255,83,94)",
        "rgb(194,98,195)",
        "rgb(255,85,179)",
        "rgb(213,214,0)",
        "rgb(141,217,237)",
        "rgb(135,254,108)",
        "rgb(203,253,195)",
        "rgb(0,163,45)",
        "rgb(233,0,166)",
        "rgb(221,221,150)",
        "rgb(154,255,242)",
        "rgb(12,106,254)",
        "rgb(252,223,194)",
        "rgb(255,0,39)",
        "rgb(197,5,228)",
        "rgb(170,225,79)",
        "rgb(169,181,243)",
        "rgb(255,0,119)",
        "rgb(129,255,0)",
        "rgb(76,224,198)",
        "rgb(6,205,84)",
        "rgb(204,218,231)",
        "rgb(253,188,29)",
        "rgb(96,188,1)",
        "rgb(182,102,253)",
        "rgb(181,255,160)",
        "rgb(239,113,198)",
        "rgb(4,211,135)",
        "rgb(138,214,111)",
        "rgb(187,255,0)",
        "rgb(234,22,222)",
        "rgb(255,0,66)",
        "rgb(255,231,74)",
        "rgb(90,105,225)",
        "rgb(249,200,120)",
        "rgb(152,173,35)",
        "rgb(0,215,0)",
        "rgb(0,255,143)",
        "rgb(255,92,55)",
        "rgb(255,195,255)",
        "rgb(58,243,255)",
        "rgb(193,211,115)",
        "rgb(178,60,217)",
        "rgb(236,61,141)",
        "rgb(253,174,59)",
        "rgb(114,144,254)",
        "rgb(255,250,125)",
        "rgb(228,255,174)",
        "rgb(252,255,73)",
        "rgb(203,255,229)",
        "rgb(218,186,17)",
        "rgb(118,216,164)",
        "rgb(189,139,223)",
        "rgb(171,254,87)",
        "rgb(166,108,210)",
        "rgb(144,255,212)",
        "rgb(159,223,216)",
        "rgb(105,222,60)",
        "rgb(255,86,238)",
        "rgb(217,254,118)",
        "rgb(177,158,255)",
        "rgb(123,187,255)",
        "rgb(255,151,79)",
        "rgb(249,255,248)",
        "rgb(255,153,206)",
        "rgb(214,92,215)",
        "rgb(241,166,255)",
        "rgb(203,199,47)",
        "rgb(187,221,0)",
        "rgb(125,255,166)",
        "rgb(81,235,172)",
        "rgb(255,240,0)",
        "rgb(255,202,219)",
        "rgb(126,187,47)",
        "rgb(210,184,237)",
        "rgb(214,35,145)",
        "rgb(235,106,34)",
        "rgb(226,39,19)",
        "rgb(87,183,80)",
        "rgb(26,158,255)",
        "rgb(254,89,22)",
        "rgb(129,88,233)",
        "rgb(131,95,213)",
        "rgb(33,225,66)",
        "rgb(184,229,116)",
        "rgb(250,65,106)",
        "rgb(255,98,80)",
        "rgb(225,191,89)",
        "rgb(185,117,241)",
        "rgb(205,229,185)",
        "rgb(216,3,179)",
        "rgb(204,170,45)",
        "rgb(139,245,255)",
        "rgb(194,214,90)",
        "rgb(216,136,0)",
        "rgb(40,164,0)",
        "rgb(253,137,9)",
        "rgb(236,219,90)",
        "rgb(214,122,232)",
        "rgb(0,255,86)",
        "rgb(156,139,255)",
        "rgb(255,253,163)",
        "rgb(162,222,42)",
        "rgb(232,31,71)",
        "rgb(247,236,255)",
        "rgb(0,186,255)",
        "rgb(0,198,219)",
        "rgb(0,208,111)",
        "rgb(255,123,246)",
        "rgb(80,113,215)",
        "rgb(230,174,69)",
        "rgb(134,235,112)",
        "rgb(165,159,236)",
        "rgb(93,208,113)",
        "rgb(238,224,173)",
        "rgb(163,232,167)",
        "rgb(221,0,255)",
        "rgb(100,255,126)",
        "rgb(185,66,180)",
        "rgb(255,249,219)",
        "rgb(179,205,56)",
        "rgb(23,143,255)",
        "rgb(255,100,158)",
        "rgb(223,91,197)",
        "rgb(115,160,0)",
        "rgb(204,70,255)",
        "rgb(189,232,255)",
        "rgb(0,189,229)",
        "rgb(219,131,220)",
        "rgb(100,103,242)",
        "rgb(215,81,228)",
        "rgb(101,231,21)",
        "rgb(205,205,237)",
        "rgb(154,255,146)",
        "rgb(164,52,255)",
        "rgb(35,237,144)",
        "rgb(114,255,232)",
        "rgb(7,224,217)",
        "rgb(237,69,184)",
        "rgb(255,145,225)",
        "rgb(113,217,255)",
        "rgb(150,90,255)",
        "rgb(133,214,58)",
        "rgb(239,213,138)",
        "rgb(198,30,212)",
        "rgb(145,255,69)",
        "rgb(0,244,47)",
        "rgb(203,229,165)",
        "rgb(179,195,0)",
        "rgb(226,7,116)",
        "rgb(84,226,86)",
        "rgb(57,191,57)",
        "rgb(146,211,88)",
        "rgb(116,136,228)",
        "rgb(224,223,114)",
        "rgb(123,225,209)",
        "rgb(81,173,49)",
        "rgb(231,0,96)",
        "rgb(236,58,255)",
        "rgb(218,166,229)",
        "rgb(196,227,223)",
        "rgb(209,250,27)",
        "rgb(184,255,213)",
        "rgb(198,242,147)",
        "rgb(191,94,231)",
        "rgb(87,151,234)",
        "rgb(255,155,45)",
        "rgb(232,255,218)",
        "rgb(255,59,200)",
        "rgb(136,233,143)",
        "rgb(91,235,190)",
        "rgb(74,203,0)",
        "rgb(161,208,114)",
        "rgb(159,241,99)",
        "rgb(199,231,63)",
        "rgb(255,65,74)",
        "rgb(180,255,59)",
        "rgb(97,255,99)",
        "rgb(218,64,193)",
        "rgb(203,204,255)",
        "rgb(202,255,98)",
        "rgb(223,223,219)",
    ]
)


def get_next_color() -> str:
    """returns the next of 256 pre-generated colors (with good contrast to black/white and maximal contrast to each other)"""
    return next(__fynns_color_palette__)


SYSTEM_COLORS: Dict[str, Tuple[float, float, float]] = __matplotlib_css_colors__


def get_random_color() -> Tuple[str, Tuple[float, float, float]]:
    return random.choice(list(SYSTEM_COLORS.items()))
